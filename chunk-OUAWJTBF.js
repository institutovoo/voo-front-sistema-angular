import{d as N,o as z,p as F,t as H}from"./chunk-NSI4Y3D4.js";import{Ca as E,Da as T,E as a,H as P,Ha as V,I as R,Ja as q,Ka as L,M as d,P as O,Pa as j,V as r,W as i,X as s,Y as m,da as C,ea as b,fa as c,g as I,j as g,ka as x,ma as f,n as u,na as M,o as _,oa as k,p as h,q as p,w as v}from"./chunk-X6FEOPPM.js";function J(t,o){t&1&&(i(0,"span",9),f(1,"*"),s())}function $(t,o){if(t&1&&(i(0,"label",7),f(1),d(2,J,2,0,"span",8),s()),t&2){let e=c();a(),k(" ",e.rotulo," "),a(),r("ngIf",e.obrigatorio)}}function K(t,o){if(t&1){let e=C();i(0,"input",10),b("input",function(l){_(e);let S=c();return h(S.aoDigitar(l))})("blur",function(){_(e);let l=c();return h(l.aoPerderFoco())}),s()}if(t&2){let e=c();r("type",e.tipoCampo)("placeholder",e.placeholder)("value",e.valor())("disabled",e.desabilitado()),O("maxlength",e.maxlength)}}function Y(t,o){if(t&1&&(i(0,"option",14),f(1),s()),t&2){let e=o.$implicit;r("value",e),a(),M(e)}}function Q(t,o){if(t&1){let e=C();i(0,"select",11),b("change",function(l){_(e);let S=c();return h(S.aoDigitar(l))})("blur",function(){_(e);let l=c();return h(l.aoPerderFoco())}),i(1,"option",12),f(2),s(),d(3,Y,2,2,"option",13),s()}if(t&2){let e=c();x("campo__controle--vazio",!e.valor()),r("value",e.valor())("disabled",e.desabilitado()),a(2),M(e.placeholder),a(),r("ngForOf",e.opcoes)}}function W(t,o){t&1&&(p(),i(0,"svg",17),m(1,"path",18)(2,"path",19),s())}function X(t,o){t&1&&(p(),i(0,"svg",17),m(1,"rect",20)(2,"path",21),s())}function Z(t,o){t&1&&(p(),i(0,"svg",17),m(1,"path",22)(2,"path",23)(3,"circle",24),s())}function ee(t,o){t&1&&(p(),i(0,"svg",17),m(1,"path",25),s())}function oe(t,o){t&1&&(p(),i(0,"svg",17),m(1,"circle",26)(2,"path",27),s())}function te(t,o){t&1&&(p(),i(0,"svg",17),m(1,"path",28)(2,"path",29)(3,"path",30)(4,"path",31),s())}function ne(t,o){if(t&1&&(i(0,"span",15),d(1,W,3,0,"svg",16)(2,X,3,0,"svg",16)(3,Z,4,0,"svg",16)(4,ee,2,0,"svg",16)(5,oe,3,0,"svg",16)(6,te,5,0,"svg",16),s()),t&2){let e=c();a(),r("ngIf",e.icone==="email"),a(),r("ngIf",e.icone==="senha"),a(),r("ngIf",e.icone==="usuario"),a(),r("ngIf",e.icone==="telefone"),a(),r("ngIf",e.icone==="busca"),a(),r("ngIf",e.icone==="documento")}}function ae(t,o){t&1&&(p(),i(0,"svg",34),m(1,"path",35)(2,"circle",36),s())}function re(t,o){t&1&&(p(),i(0,"svg",34),m(1,"path",37)(2,"line",38),s())}function ie(t,o){if(t&1){let e=C();i(0,"button",32),b("click",function(){_(e);let l=c();return h(l.alternarSenha())}),d(1,ae,3,0,"svg",33)(2,re,3,0,"svg",33),s()}if(t&2){let e=c();a(),r("ngIf",!e.senhaVisivel()),a(),r("ngIf",e.senhaVisivel())}}var D=class t{constructor(o){this.ngControl=o;this.ngControl&&(this.ngControl.valueAccessor=this)}tipo="text";placeholder="";rotulo="";icone=null;mostrarAlternarSenha=!1;maxlength=null;obrigatorio=!1;opcoes=[];valor=v("");senhaVisivel=v(!1);desabilitado=v(!1);aoMudar=()=>{};aoTocar=()=>{};writeValue(o){this.valor.set(o||"")}registerOnChange(o){this.aoMudar=o}registerOnTouched(o){this.aoTocar=o}setDisabledState(o){this.desabilitado.set(o)}aoDigitar(o){let e=o.target;this.valor.set(e.value),this.aoMudar(e.value)}aoPerderFoco(){this.aoTocar()}alternarSenha(){this.senhaVisivel.update(o=>!o)}get tipoCampo(){return this.tipo==="password"&&this.senhaVisivel()?"text":this.tipo}get temErro(){return!!(this.ngControl&&this.ngControl.invalid&&(this.ngControl.touched||this.ngControl.dirty))}static \u0275fac=function(e){return new(e||t)(P(N,10))};static \u0275cmp=R({type:t,selectors:[["app-campo"]],inputs:{tipo:"tipo",placeholder:"placeholder",rotulo:"rotulo",icone:"icone",mostrarAlternarSenha:"mostrarAlternarSenha",maxlength:"maxlength",obrigatorio:"obrigatorio",opcoes:"opcoes"},decls:7,vars:13,consts:[[1,"campo-wrapper"],["class","campo__rotulo",4,"ngIf"],[1,"campo"],["class","campo__controle",3,"type","placeholder","value","disabled","input","blur",4,"ngIf"],["class","campo__controle campo__controle--select",3,"value","disabled","campo__controle--vazio","change","blur",4,"ngIf"],["class","campo__icone campo__icone--esquerda","aria-hidden","true",4,"ngIf"],["type","button","class","campo__icone campo__icone--direita","aria-label","Mostrar ou ocultar senha",3,"click",4,"ngIf"],[1,"campo__rotulo"],["class","campo__obrigatorio","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"campo__obrigatorio"],[1,"campo__controle",3,"input","blur","type","placeholder","value","disabled"],[1,"campo__controle","campo__controle--select",3,"change","blur","value","disabled"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["aria-hidden","true",1,"campo__icone","campo__icone--esquerda"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M4 4h16v16H4z"],["d","M22 6l-10 7L2 6"],["x","3","y","11","width","18","height","10","rx","2","ry","2"],["d","M7 11V7a5 5 0 0 1 10 0v4"],["d","M20 21v-2a4 4 0 0 0-3-3.87"],["d","M4 21v-2a4 4 0 0 1 3-3.87"],["cx","12","cy","7","r","4"],["d","M22 16.92v3a2 2 0 0 1-2.18 2A19.79 19.79 0 0 1 3.08 5.26 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.72c.12.9.35 1.77.68 2.58a2 2 0 0 1-.45 2.11L9 10a16 16 0 0 0 5 5l.59-.59a2 2 0 0 1 2.11-.45c.81.33 1.68.56 2.58.68A2 2 0 0 1 22 16.92z"],["cx","11","cy","11","r","8"],["d","M21 21l-4.35-4.35"],["d","M7 3h10a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"],["d","M9 7h6"],["d","M9 11h6"],["d","M9 15h4"],["type","button","aria-label","Mostrar ou ocultar senha",1,"campo__icone","campo__icone--direita",3,"click"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",4,"ngIf"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7z"],["cx","12","cy","12","r","3"],["d","M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"],["x1","1","y1","1","x2","23","y2","23"]],template:function(e,n){e&1&&(i(0,"div",0),d(1,$,3,2,"label",1),i(2,"div",2),d(3,K,1,5,"input",3)(4,Q,4,6,"select",4)(5,ne,7,6,"span",5)(6,ie,3,2,"button",6),s()()),e&2&&(x("campo-wrapper--erro",n.temErro),a(),r("ngIf",n.rotulo),a(),x("campo--com-icone-esquerda",n.icone)("campo--com-icone-direita",n.mostrarAlternarSenha&&n.tipo==="password")("campo--erro",n.temErro),a(),r("ngIf",n.tipo!=="select"),a(),r("ngIf",n.tipo==="select"),a(),r("ngIf",n.icone),a(),r("ngIf",n.mostrarAlternarSenha&&n.tipo==="password"))},dependencies:[V,E,T,H,z,F],styles:[`.campo-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.campo[_ngcontent-%COMP%]{position:relative;display:block}.campo__rotulo[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:.5rem}.campo__obrigatorio[_ngcontent-%COMP%]{color:#dc3545;margin-left:2px}.campo__controle[_ngcontent-%COMP%]{width:100%;height:44px;border:1px solid #e0e6ed;border-radius:12px;padding:0 12px;background:#fff;color:#0b1b2b;outline:none;transition:border-color .15s ease,box-shadow .15s ease;font-size:14px}.campo__controle[_ngcontent-%COMP%]::placeholder{color:#8b9aa8}.campo__controle[_ngcontent-%COMP%]:disabled{background:#f5f7fa;cursor:not-allowed}.campo__controle--select[_ngcontent-%COMP%]{appearance:none;cursor:pointer;padding-right:40px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23607081' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;background-size:16px}.campo__controle--select--vazio[_ngcontent-%COMP%]{color:#8b9aa8}.campo__controle--select[_ngcontent-%COMP%]:invalid, .campo__controle--select[value=""][_ngcontent-%COMP%], .campo__controle--select[_ngcontent-%COMP%]   option[value=""][_ngcontent-%COMP%]{color:#8b9aa8}.campo__controle--select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#0b1b2b;padding:12px}.campo--com-icone-esquerda[_ngcontent-%COMP%]   .campo__controle[_ngcontent-%COMP%]{padding-left:40px}.campo--com-icone-direita[_ngcontent-%COMP%]   .campo__controle[_ngcontent-%COMP%]{padding-right:44px}.campo__icone[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);display:inline-flex;align-items:center;justify-content:center;color:#607081;transition:color .15s ease}.campo__icone--esquerda[_ngcontent-%COMP%]{left:12px;pointer-events:none}.campo__icone--direita[_ngcontent-%COMP%]{right:8px;width:32px;height:32px;border:none;border-radius:8px;background:transparent;cursor:pointer}.campo__icone--direita[_ngcontent-%COMP%]:hover{background:#f0f4f8}.campo[_ngcontent-%COMP%]:focus-within   .campo__controle[_ngcontent-%COMP%]{border-color:var(--color-primary);box-shadow:0 0 0 3px #0dc0c733,0 0 0 1px var(--color-primary)}.campo[_ngcontent-%COMP%]:focus-within   .campo__icone[_ngcontent-%COMP%]{color:var(--color-primary)}.campo[_ngcontent-%COMP%]:focus-within   .campo__controle--select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%230dc0c7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")}.campo--erro[_ngcontent-%COMP%]   .campo__icone[_ngcontent-%COMP%]{color:#dc3545}`]})};var w=class t{http=u(L);API_URL="https://5axe4j6ztxumduquhtim6icgg40tlimo.lambda-url.us-east-1.on.aws";getHeaders(){return new q({"Content-Type":"application/json"})}cadastrar(o){return this.http.post(`${this.API_URL}/usuarios`,o,{headers:this.getHeaders()})}login(o){return this.http.post(`${this.API_URL}/usuarios/login`,o,{headers:this.getHeaders()})}esqueciSenha(o){return this.http.post(`${this.API_URL}/usuarios/esqueci-senha`,o,{headers:this.getHeaders()})}resetSenha(o){return this.http.post(`${this.API_URL}/usuarios/reset-senha`,o,{headers:this.getHeaders()})}me(){return this.http.get(`${this.API_URL}/usuarios/me`,{headers:this.getHeaders()})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};function U(t,o){try{let e=localStorage.getItem(t);return e?JSON.parse(e):o}catch{return o}}function G(t,o){try{localStorage.setItem(t,JSON.stringify(o))}catch{}}var y=class t{api=u(w);usuarioLogado=v(U("usuario",null));cadastrar(o){return this.api.cadastrar(o)}login(o){return this.api.login(o).pipe(I(e=>{e.sucesso&&e.token&&e.usuario&&(localStorage.setItem("token",e.token),G("usuario",e.usuario),this.usuarioLogado.set(e.usuario))}))}esqueciSenha(o){return this.api.esqueciSenha({email:o})}logout(){localStorage.removeItem("token"),localStorage.removeItem("usuario"),this.usuarioLogado.set(null)}estaLogado(){return!!localStorage.getItem("token")}static \u0275fac=function(e){return new(e||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};var B=class t{service=u(y);router=u(j);get usuarioLogado(){return this.service.usuarioLogado}async login(o){try{return console.log("[AutenticacaoController] Iniciando tentativa de login para:",o.cpf_cnpj),new Promise(e=>{this.service.login(o).subscribe({next:n=>{console.log("[AutenticacaoController] Resposta da API recebida:",n),n.sucesso?(console.log("[AutenticacaoController] Login bem-sucedido! Redirecionando..."),this.router.navigate(["/"]),e({sucesso:!0})):(console.warn("[AutenticacaoController] Falha no login:",n.mensagem),e({sucesso:!1,mensagem:n.mensagem||"Erro ao realizar login"}))},error:n=>{console.error("[AutenticacaoController] Erro de rede ou servidor ao logar:",n),e({sucesso:!1,mensagem:"Erro de conex\xE3o ou credenciais inv\xE1lidas"})}})})}catch(e){return console.error("[AutenticacaoController] Erro inesperado no m\xE9todo login:",e),{sucesso:!1,mensagem:"Erro inesperado"}}}async cadastrar(o){return console.log("[AutenticacaoController] Iniciando cadastro para:",o.cpf_cnpj),new Promise(e=>{this.service.cadastrar(o).subscribe({next:n=>{console.log("[AutenticacaoController] Resposta do cadastro:",n),n.sucesso||n.id?(console.log("[AutenticacaoController] Cadastro OK. Redirecionando para login em 2s..."),setTimeout(()=>this.router.navigate(["/autenticacao/login"]),2e3),e({sucesso:!0,mensagem:"Cadastro realizado com sucesso! Redirecionando..."})):(console.warn("[AutenticacaoController] Falha no cadastro:",n.mensagem),e({sucesso:!1,mensagem:n.mensagem||"Erro ao realizar cadastro"}))},error:n=>{console.error("[AutenticacaoController] Erro de rede ou servidor ao cadastrar:",n),e({sucesso:!1,mensagem:"Erro ao realizar cadastro. Tente novamente."})}})})}async esqueciSenha(o){return console.log("[AutenticacaoController] Solicitando recupera\xE7\xE3o de senha para:",o),new Promise(e=>{this.service.esqueciSenha(o).subscribe({next:n=>{console.log("[AutenticacaoController] Resposta da recupera\xE7\xE3o:",n),e({sucesso:!0,mensagem:n.mensagem||"Se o e-mail estiver cadastrado, voc\xEA receber\xE1 instru\xE7\xF5es."})},error:n=>{console.error("[AutenticacaoController] Erro ao solicitar recupera\xE7\xE3o:",n),e({sucesso:!1,mensagem:"Erro ao solicitar recupera\xE7\xE3o. Tente novamente."})}})})}logout(){this.service.logout(),this.router.navigate(["/autenticacao/login"])}static \u0275fac=function(e){return new(e||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};export{D as a,B as b};
