<app-sistema-layout
  [usuario]="{ nome: usuarioLogado()?.nome_completo || 'Administrador' }"
  tipoUsuario="admin"
>
  <div class="solicitacoes">
    <div class="solicitacoes__header">
      <div class="info">
        <h1 class="solicitacoes__titulo">Aprovações de acesso</h1>
        <p class="solicitacoes__subtitulo">
          Gerencie as solicitações de acesso administrativo pendentes. Revise cuidadosamente as
          informações antes de conceder permissões de alto nível.
        </p>
      </div>
      @if (!carregando()) {
        <div class="contador">
          <span class="numero">{{ solicitacoes().length }}</span>
          <span class="label">pendentes</span>
        </div>
      }
    </div>

    <div class="lista">
      @if (carregando()) {
        <div class="loading-overlay">
          <p>Carregando solicitações...</p>
        </div>
      }

      @if (!carregando() && solicitacoes().length === 0) {
        <div class="card-vazio">
          <div class="icone-vazio">
            <app-header-icone nome="verificar" [tamanho]="48"></app-header-icone>
          </div>
          <h3>Tudo em dia!</h3>
          <p>
            Não há solicitações de acesso pendentes no momento. O ecossistema administrativo está
            atualizado.
          </p>
        </div>
      }

      @for (s of solicitacoes(); track s.id) {
        <div class="solicitacao-card" [class.saindo]="s.status !== 'pendente'">
          <div class="solicitacao-card__usuario">
            <div class="avatar">
              {{ s.usuario?.nome_completo?.charAt(0) }}
            </div>
            <div class="detalhes">
              <h3 class="nome">{{ s.usuario?.nome_completo }}</h3>
              <span class="email">{{ s.usuario?.email }}</span>
            </div>
          </div>

          <div class="solicitacao-card__info">
            <div class="item">
              <span class="label">Perfil solicitado</span>
              <span class="valor">{{ s.perfil }}</span>
            </div>
            <div class="item">
              <span class="label">Solicitado em</span>
              <span class="valor">{{ s.dataCriacao | date: 'dd/MM/yyyy HH:mm' }}</span>
            </div>
          </div>

          <div class="solicitacao-card__acoes">
            <button class="btn-rejeitar" (click)="rejeitar(s.id)">
              <app-header-icone nome="bloquear" [tamanho]="18"></app-header-icone>
              Rejeitar
            </button>
            <button class="btn-aprovar" (click)="aprovar(s.id)">
              <app-header-icone nome="verificar" [tamanho]="18"></app-header-icone>
              Aprovar acesso
            </button>
          </div>
        </div>
      }
    </div>
  </div>
</app-sistema-layout>
